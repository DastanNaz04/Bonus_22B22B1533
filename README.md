# Бонусное задание: Mini Data Pipeline (Web Scraping → Kafka)

**Идентификатор студента (STUDENT_ID):** 22B22B1533

## 1. Источник данных (URL)

Данные о самых высоких зданиях мира были извлечены из таблицы на Википедии:

**URL:** https://ru.wikipedia.org/wiki/Список_самых_высоких_зданий_мира

## 2. Описание данных

Скрипт `script.py` извлекает 20 первых строк из основной таблицы, содержащей информацию о мировых небоскребах.

**Извлеченные поля:** Ранг, Название, Город, Высота по верхнему конструктивному элементу, Высота антенны, Этажность, Год окончания постройки, Примечания.

## 3. Операции по очистке данных (6 шагов)

Для подготовки данных к отправке в Kafka были выполнены следующие 6 операций очистки (Data Cleaning Operations):

| № | Операция | Описание |
| :--- | :--- | :--- |
| **ОП1** | **Переименование столбцов** | Ключевые столбцы переименованы для стандартизации: `Ранг` -> `Rank`, `Название` -> `Building_Name`, `Город` -> `City`, и основной столбец высоты -> `Height_Meters`. |
| **ОП2** | **Удаление лишних столбцов** | Удалены ненужные столбцы, связанные с дополнительными метриками (например, содержащие слова 'фут', 'шпилю', 'крыше', 'постройки' и 'Этажность'), чтобы сохранить только минимальный набор данных. |
| **ОП3** | **Удаление сносок** | Из строковых полей (`Building_Name`, `City`) удалены квадратные скобки со сносками (например, `[1]`, `[a]`) с использованием регулярных выражений. |
| **ОП4** | **Приведение к нижнему регистру** | Строковые поля (`Building_Name`, `City`) приведены к нижнему регистру для стандартизации текста. |
| **ОП5** | **Преобразование числового столбца** | Извлечено только первое числовое значение (метры) из столбца `Height_Meters`, и оно приведено к числовому типу данных (`float`). |
| **ОП6** | **Удаление строк с NaN** | Удалены строки, в которых поле `Height_Meters` после преобразования стало невалидным (`NaN`), или отсутствует `Building_Name`. |

## 4. Отправка в Kafka

Каждая очищенная строка отправляется в брокер Kafka как отдельное JSON-сообщение.

**Название топика:** `bonus_22B22B1533`

### Пример JSON-сообщения (Sample Kafka Message)

Ниже представлен пример JSON-сообщения, полученного консольным консьюмером из топика:

```json
{
    "Rank": "1",
    "Building_Name": "бурдж-халифа",
    "City": "дубай",
    "Height_Meters": 828.0,
    "Фото": "",
    "Высота антенны, м": "&&&&&&&&&&&&0829.800000829,8",
    "Высота последнего эксплуатируемого этажа, м": "&&&&&&&&&&&&0584.500000584,5",
    "Примечания": "Самое высокое сооружение и самое высокое многофункциональное здание в мире[2]"
}